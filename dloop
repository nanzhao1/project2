dloop = function(n, nreps){
  prob = array(0,2*n)
  Box = array(1:(2*n))
  for (i in 1:nreps){
    Card = sample(Box, 2*n)
    frequ = array(0,2*n)
    for (k in 1:(2*n)) {
      Box_index = k
      trials = 1
      while (Card[Box_index] != k) {
        Box_index = Card[Box_index]
        trials = trials + 1
      }
      frequ[trials] = frequ[trials] + 1
    }
    maxlength = max(frequ)
    prob[maxlength] = prob[maxlength] + 1
  }
  return(prob/nreps)
}
